<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Inazuma Eleven - SelecciÃ³n de Equipo</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>âš¡ Inazuma Eleven - Crea tu Equipo</h1>

  <!-- EstadÃ­sticas del equipo -->
  <section id="stats">
    <h2>ğŸ“Š EstadÃ­sticas del equipo</h2>
    <div class="stats-container">
      <p><strong>Ataque:</strong> {{ stats.ataque }}</p>
      <p><strong>Defensa:</strong> {{ stats.defensa }}</p>
      <p><strong>TÃ©cnica:</strong> {{ stats.tecnica }}</p>
      <p><strong>Resistencia:</strong> {{ stats.resistencia }}</p>
    </div>
  </section>

  <!-- Lista de jugadores disponibles -->
  <section id="players">
    <h2>ğŸ‘¥ Jugadores disponibles</h2>
    <div class="player-grid">
      {% for player in players %}
      <div class="player-card">
        <img src="{{ player.foto }}" alt="{{ player.nombre }}">
        <h3>{{ player.nombre }}</h3>
        <p>{{ player.posiciÃ³n }}</p>
        <p>âš”ï¸ Ataque: {{ player.ataque }}</p>
        <p>ğŸ›¡ï¸ Defensa: {{ player.defensa }}</p>
        <p>ğŸ¯ TÃ©cnica: {{ player.tÃ©cnica }}</p>
        <p>ğŸ’ª Resistencia: {{ player.resistencia }}</p>
        <button class="add-btn" onclick="addToTeam('{{ player.nombre }}')">â• AÃ±adir al equipo</button>
      </div>
      {% endfor %}
    </div>
  </section>

  <!-- Equipo actual -->
  <section id="team-section">
    <h2>ğŸ§¤ Tu Equipo Actual ({{ team|length }}/11)</h2>
    <div id="team-list">
      {% for member in team %}
      <div class="team-card">
        <img src="{{ member.foto }}" alt="{{ member.nombre }}">
        <h3>{{ member.nombre }}</h3>
        <p>{{ member.posiciÃ³n }}</p>
        <button class="remove-btn" onclick="removeFromTeam('{{ member.nombre }}')">âŒ Quitar</button>
      </div>
      {% endfor %}
    </div>

    <!-- BotÃ³n para ver formaciÃ³n -->
    <div id="view-formation" style="display: {{ 'block' if team|length == 11 else 'none' }}; text-align:center; margin-top:20px;">
      <a href="/formation" class="btn">âš½ Ver FormaciÃ³n</a>
    </div>
  </section>

  <script>
    let team = {{ team|tojson }};
    const players = {{ players|tojson }};

    function getPlayerByName(name) {
      return players.find(p => p.nombre === name);
    }

    function addToTeam(name) {
      if (team.length >= 11) {
        alert("âš ï¸ Ya tienes 11 jugadores en tu equipo.");
        return;
      }

      const player = getPlayerByName(name);
      if (!player) return;

      fetch('/save_team', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ team: [...team, player], formation: "4-4-2" })
      })
      .then(res => res.json())
      .then(data => {
        team.push(player);
        location.reload();
      });
    }

    function removeFromTeam(name) {
      team = team.filter(p => p.nombre !== name);

      fetch('/save_team', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ team: team, formation: "4-4-2" })
      })
      .then(res => res.json())
      .then(() => location.reload());
    }
  </script>
</body>
</html>
